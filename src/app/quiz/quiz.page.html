<ion-content [fullscreen]="true" class="quiz-content">
  <div class="quiz-wrapper">
    <app-quiz-loading *ngIf="view === 'loading'"></app-quiz-loading>

    <app-quiz-unavailable
      *ngIf="view === 'unavailable'"
      [rankInfo]="rankInfo"
      [xpToNextRankText]="xpToNextRankText"
      [stats]="stats"
      [averagePercent]="averagePercent"
      [daysActiveLabelKey]="daysActiveLabelKey"
      (goHome)="goHome()"
    ></app-quiz-unavailable>

    <app-quiz-question-card
      *ngIf="view === 'question' && currentQuestion"
      [question]="currentQuestion"
      [currentIndex]="currentIndex"
      [totalQuestions]="totalQuestions"
      [selectedIndex]="selectedIndex"
      [optionLabels]="optionLabels"
      [questionProgressPercent]="questionProgressPercent"
      [stats]="stats"
      [rankInfo]="rankInfo"
      [averagePercent]="averagePercent"
      [daysActiveLabelKey]="daysActiveLabelKey"
      (selectOption)="selectOption($event)"
      (next)="next()"
    ></app-quiz-question-card>

    <app-quiz-result-view
      *ngIf="view === 'result'"
      [resultEmoji]="resultEmoji"
      [resultTitleKey]="resultTitleKey"
      [resultSubtitleKey]="resultSubtitleKey"
      [resultScorePhrase]="resultScorePhrase"
      [isPerfect]="correctCount >= totalQuestions"
      [displayedProgress]="displayedProgress"
      [correctCount]="correctCount"
      [totalQuestions]="totalQuestions"
      [ringCircumference]="ringCircumference"
      [dayStreakText]="dayStreakText"
      [xpEarnedText]="xpEarnedText"
      [showStreak]="stats.streak > 0"
      [rankJustUpgraded]="rankJustUpgraded"
      [rankUpMessage]="rankUpMessage"
      [rankInfo]="rankInfo"
      [xpToNextRankText]="xpToNextRankText"
      [stats]="stats"
      [averagePercent]="averagePercent"
      [daysActiveLabelKey]="daysActiveLabelKey"
      (goHome)="goHome()"
    ></app-quiz-result-view>
  </div>

  <app-quiz-confetti
    *ngIf="view === 'result' && confettiParticles.length"
    [particles]="confettiParticles"
  ></app-quiz-confetti>
</ion-content>
